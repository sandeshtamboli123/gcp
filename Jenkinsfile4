pipeline {
     agent {
        kubernetes {
            defaultContainer 'jnlp'
            yamlFile 'jenkins.yaml'
        }
    }
     stages {     
         stage('Docker build and tag') {
            steps {
               sh 'docker build -t jenkins-argocd:latest .' 
               sh 'docker tag jenkins-argocd mynamesandesh/jenkins-argocd:$BUILD_NUMBER'
            }
         }

         stage('Push Docker Image to dockerhub') {
            steps {
				withDockerRegistry([ credentialsId: "dockerHub", url: "" ]) {
					sh 'docker push  mynamesandesh/jenkins-argocd:$BUILD_NUMBER'
                } 
            }  
         }
     } 
} 

